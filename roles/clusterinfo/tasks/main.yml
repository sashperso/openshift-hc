---
  - name: Cluster ID
    shell: "{{ OC }} get clusterversion -o jsonpath='{.items[].spec.clusterID}'"
    ignore_errors: true
    register: cluster_id
    changed_when: false

  - name: Cluster API
    shell: "{{ OC }} whoami --show-server=true"
    ignore_errors: true
    register: cluster_api
    changed_when: false
  
  - name: Cluster Version
    shell: "{{ OC }} get clusterversion/version -o jsonpath='{.status.desired.version}'"
    ignore_errors: true
    register: cluster_version
    changed_when: false

  - name: Cluster DNS Name
    shell: "{{ OC }} get dns cluster -o jsonpath='{.spec.baseDomain}'"
    ignore_errors: true
    register: cluster_dns_name

  - name: Cluster Network Type
    shell: "{{ OC }} get networks.operator.openshift.io -o jsonpath='{.items[].spec.defaultNetwork.type}'"
    ignore_errors: true
    register: cluster_network_type

  - name: Platform
    shell: "{{ OC }} get controlplanemachineset.machine.openshift.io cluster -n openshift-machine-api -o jsonpath='{.spec.template.machines_v1beta1_machine_openshift_io.failureDomains.platform}'"
    ignore_errors: true
    register: cluster_platform
  
  - name: Getting the number of Nodes
    shell: "{{ OC }} get nodes --no-headers | wc -l | tr -d ' '"
    ignore_errors: true
    register: cluster_nodes

  - name: Getting all namespaces
    shell: "{{ OC }} get namespaces --all-namespaces --no-headers | wc -l | tr -d ' '"
    ignore_errors: true
    register: cluster_namespaces

  - name: Getting the number of builds
    shell: "{{ OC }} get builds --all-namespaces -no-headers | wc -l | tr -d ' '"
    ignore_errors: true
    register: cluster_builds

  - name: Openshift Channel
    shell: "{{ OC }} get clusterversion/version -o jsonpath='{.spec.channel}'"
    ignore_errors: true
    register: cluster_update_channel
  
  - name: Openshift Update Available
    shell: "{{ OC }} get clusterversion/version -o jsonpath='{.status.availableUpdates[0].version}'"
    ignore_errors: true
    register: cluster_update
  
  - name: Check if the instalation was IPI or UPI
    shell:  "{{ OC }} get cm openshift-install --no-headers -o=custom-columns=NAME:metadata.name -n openshift-config"
    register: cluster_instalation_check
    ignore_errors: true

  - name: Getting the number of build configs
    shell: "{{ OC }} get bc --all-namespaces --no-headers | wc -l | tr -d ' '"
    ignore_errors: true
    register: cluster_bc

  - name: Getting the number of services
    shell: "{{ OC }} get services --all-namespaces --no-headers | wc -l | tr -d ' '"
    ignore_errors: true
    register: cluster_services

  - name: Getting the number of CRDS
    shell: "{{ OC }} get crd | wc -l | tr -d ' '"
    ignore_errors: true
    register: cluster_crds

  - name: Getting the number of secrets
    shell: "{{ OC }} get secret --all-namespaces --no-headers | wc -l | tr -d ' '"
    ignore_errors: true
    register: cluster_secrets

  - name: Getting configmaps
    shell: "{{ OC }} get cm --all-namespaces --no-headers | wc -l | tr -d ' '"
    ignore_errors: true
    register: cluster_configmaps
  

  - name: Set the fact  variable names
    set_fact: 
      cluster_id: "{{ cluster_id.stdout }}"
      cluster_api: "{{ cluster_api.stdout }}"
      cluster_version: "{{ cluster_version.stdout }}"
      cluster_dns_name: "{{ cluster_dns_name.stdout }}"
      cluster_network_type: "{{ cluster_network_type.stdout }}"
      cluster_platform: "{{ cluster_platform.stdout }}"
      cluster_nodes: "{{ cluster_nodes.stdout }}"
      cluster_namespaces: "{{ cluster_namespaces.stdout }}"
      cluster_builds: "{{ cluster_builds.stdout }}"
      cluster_update_channel: "{{ cluster_update_channel.stdout }}"
      cluster_update: "{{ cluster_update.stdout }}"
      cluster_instalation_check: "{{ cluster_instalation_check.stdout }}"
      cluster_bc: "{{ cluster_bc.stdout }}"
      cluster_services: "{{ cluster_services.stdout }}"
      cluster_crds: "{{ cluster_crds.stdout }}"
      cluster_secrets: "{{ cluster_secrets.stdout }}"
      cluster_configmaps: "{{ cluster_configmaps.stdout }}"
